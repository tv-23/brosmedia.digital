<section class="our-team-section">
  <!-- Section Title -->
  <div class="container section-title" data-aos="fade-up">
    <h2>Rencontrez notre équipe</h2>
  </div><!-- End Section Title -->

  <div style="background-color: #0a0f4f;">
  <div class="container" id="our-team-section">
    <div class="row align-items-center">
      <!-- Left Column - Profile Image -->
      <div class="col-lg-5 mb-5 mb-lg-0">
        <div class="profile-container">
          <img
            id="testimonial-image"
            class="profile-image fade-target"
            src="/img/team/Hamza-Charif-Tribak.webp"
            alt="Profile Image"
          />
          <div id="orange-circle" class="orange-circle"></div>
          <div id="blue-shape" class="blue-shape"></div>
        </div>
      </div>

      <!-- Right Column - Testimonial Content -->
      <div class="col-lg-7">
        <div id="company-heading" class="uppercase-heading fade-target">
          FONDATEUR
        </div>
        <h2 id="our-team-description" class="quote-text fade-target">
         Brosmedia, fondée par Hamza après un parcours accompli en programmation et en freelance, offre des solutions digitales complètes : création de sites web, marketing digital et production de contenu. Sa vision stratégique et son esprit entrepreneurial en font un partenaire de choix pour développer votre présence en ligne.
        </h2>
      </div>
    </div>

    <!-- Logo Section -->
    <div class="row logo-section">
      <div class="col-12">
        <div class="logo-wrapper position-relative">
          <div class="logo-line" id="logo-line"></div>

          <div class="logo-item active" data-company="lumen">
            <span class="logo-text">Hamza</span>
          </div>
          <div class="logo-item" data-company="mercedes">
            <span class="logo-text">Youssra</span>
          </div>
          <div class="logo-item" data-company="roblox">
            <span class="logo-text">Abdelaziz</span>
          </div>
          <div class="logo-item" data-company="royal">
            <span class="logo-text">Yassmine</span>
          </div>
          <div class="logo-item" data-company="doodle">
            <span class="logo-text">Firdaws</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</section>

<script>
  // -------------------------------
  // Testimonial data (copied/expanded from your earlier object)
  // -------------------------------
  const testimonials = {
    lumen: {
      heading: "FONDATEUR",
      quote:
        "Brosmedia, fondée par Hamza après un parcours accompli en programmation et en freelance, offre des solutions digitales complètes : création de sites web, marketing digital et production de contenu. Sa vision stratégique et son esprit entrepreneurial en font un partenaire de choix pour développer votre présence en ligne.",
      image: "/img/team/Hamza-Charif-Tribak.webp",
    },
    mercedes: {
      heading: "Chef Officier Technique",
      quote:
        "Après avoir brillamment réussi en programmation et développé une solide expertise technique, Yousra a rejoint son frère Hamza pour co-diriger Brosmedia. Alliant savoir-faire et créativité, elle supervise la direction technique, assurant qualité et innovation dans chaque projet digital.",
      image: "/img/team/yousra-charif-tribak.webp",
    },
    roblox: {
      heading: "Chef de département technique",
      quote:
        "Abdelaziz, chef du département technique et partenaire clé, supervise tous les projets de développement pour garantir les standards de qualité les plus élevés. Il coordonne les équipes, établit les bonnes pratiques et accompagne les stagiaires en transmettant son expertise. Sa rigueur et son savoir-faire font de lui un pilier essentiel de Brosmedia.",
      image: "/img/team/abdaziz.webp",
    },
    royal: {
      heading: "HOSPITALITY",
      name: "LISA LUTOFF-PERLO",
      title: "CEO, Royal Caribbean",
      quote:
        "Our booking system now handles 500% more traffic during promotions with zero downtime or performance issues.",
      caseStudy: "Read Royal Caribbean's case study →",
      image: "/img/team/firdaws.webp",
      orangeCircle: "#FF9D35",
      blueShape: "#00C2CB",
    },
    doodle: {
      heading: "PRODUCTIVITY",
      name: "RENATO SIMIC",
      title: "CTO, Doodle",
      quote:
        "User engagement increased by 75% after implementing the new scheduling algorithms and interface improvements.",
      caseStudy: "Read Doodle's case study →",
      image: "/img/team/yassmine.webp",
      orangeCircle: "#FF5252",
      blueShape: "#536DFE",
    },
  };

  // -------------------------------
  // DOM Elements
  // -------------------------------
  const testimonialSection = document.getElementById("our-team-section");
  const companyHeading = document.getElementById("company-heading");
  const testimonialQuote = document.getElementById("our-team-description");
  const testimonialImage = document.getElementById("testimonial-image");
  const orangeCircle = document.getElementById("orange-circle");
  const blueShape = document.getElementById("blue-shape");

  const logoWrapper = document.querySelector(".logo-wrapper");
  const logoItems = Array.from(document.querySelectorAll(".logo-item"));
  const logoLine = document.getElementById("logo-line");

  // Keys + state
  const companyKeys = logoItems.map((li) => li.dataset.company);
  let currentIndex = 0;
  let wheelThrottle = false;

  // Helper: fade targets list
  const fadeTargets = [
    companyHeading,
    testimonialQuote,
    testimonialImage,
  ];

  // -------------------------------
  // Update testimonial content
  // -------------------------------
  function updateTestimonial(index) {
    const key = companyKeys[index];
    const data = testimonials[key];

    // Fade out
    fadeTargets.forEach((el) => (el.style.opacity = 0));

    setTimeout(() => {
      // Update content
      companyHeading.textContent = data.heading;
      testimonialQuote.textContent = data.quote;
      testimonialImage.src = data.image;

      // Fade in
      fadeTargets.forEach((el) => (el.style.opacity = 1));
    }, 220);

    // Logos: mark all up to index as active
    logoItems.forEach((el, i) => el.classList.toggle("active", i <= index));

    // Update progress line
    updateLineProgress(index);
  }

  // -------------------------------
  // Update the white progress line
  // -------------------------------
  function updateLineProgress(index) {
    const firstLogo = logoItems[0];
    const lastActiveLogo = logoItems[index];

    const wrapperRect = logoWrapper.getBoundingClientRect();
    const firstRect = firstLogo.getBoundingClientRect();
    const lastRect = lastActiveLogo.getBoundingClientRect();

    const firstCenter = firstRect.left - wrapperRect.left + firstRect.width / 2;
    const lastCenter = lastRect.left - wrapperRect.left + lastRect.width / 2;

    const width = Math.max(0, lastCenter - firstCenter);

    // set left to first center and width to difference
    logoLine.style.left = `${firstCenter}px`;
    logoLine.style.width = `${width}px`;
  }

  // -------------------------------
  // Click on logos
  // -------------------------------
  logoItems.forEach((item, idx) => {
    item.addEventListener("click", () => {
      currentIndex = idx;
      updateTestimonial(currentIndex);
    });
  });

  // -------------------------------
  // Wheel (scroll) navigation
  // -------------------------------
  testimonialSection.addEventListener(
    "wheel",
    (ev) => {
      // prevent page scroll while interacting
      ev.preventDefault();

      if (wheelThrottle) return;
      wheelThrottle = true;
      setTimeout(() => (wheelThrottle = false), 350); // small throttle

      if (ev.deltaY > 0 && currentIndex < companyKeys.length - 1) {
        currentIndex++;
        updateTestimonial(currentIndex);
      } else if (ev.deltaY < 0 && currentIndex > 0) {
        currentIndex--;
        updateTestimonial(currentIndex);
      }
    },
    { passive: false },
  );

  // -------------------------------
  // Init and responsive updates
  // -------------------------------
  window.addEventListener("resize", () => updateLineProgress(currentIndex));

  // Wait for DOM ready (images may be cached)
  document.addEventListener("DOMContentLoaded", () => {
    // ensure the logo line is positioned correctly after layout
    // small timeout to allow fonts/bootstrap layout to settle
    setTimeout(() => {
      updateTestimonial(currentIndex);
    }, 60);
  });
</script>
